# üîß –û—Ç—á–µ—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏

**–î–∞—Ç–∞:** 7 –æ–∫—Ç—è–±—Ä—è 2025  
**–ó–∞–¥–∞—á–∞:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫—É –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ `/categories`

## üêõ –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫–∞—Ç–µ–≥–æ—Ä–∏–π (`/categories`) –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥–µ–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ "–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã", —Ö–æ—Ç—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–æ 5 –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π.

## üîç –ü—Ä–∏—á–∏–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã

–ë—ã–ª–æ –≤—ã—è–≤–ª–µ–Ω–æ **–¥–≤–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã**:

### 1. **Backend: –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ endpoint**

–í –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ `/backend/src/categories/categories.controller.ts`:
- –ù–∞ —É—Ä–æ–≤–Ω–µ –≤—Å–µ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ –±—ã–ª —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω guard `@UseGuards(JwtAuthGuard)`
- –≠—Ç–æ —Ç—Ä–µ–±–æ–≤–∞–ª–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª—è **–≤—Å–µ—Ö** –º–µ—Ç–æ–¥–æ–≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞, –≤–∫–ª—é—á–∞—è –ø—É–±–ª–∏—á–Ω—ã–π GET `/categories`
- –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–ª—É—á–∞–ª–∏ –æ—à–∏–±–∫—É 401 Unauthorized

### 2. **Nginx: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –º–∞—Ä—à—Ä—É—Ç–æ–≤ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π**

–í –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Nginx (`/etc/nginx/sites-available/birdwatching`):
- –ú–∞—Ä—à—Ä—É—Ç—ã API –±—ã–ª–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ –¥–ª—è: `/excursions`, `/bookings`, `/users`
- –ó–∞–ø—Ä–æ—Å—ã –∫ `/categories`, `/subscriptions` –∏ `/telegram` –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–ª–∏—Å—å –Ω–∞ frontend –≤–º–µ—Å—Ç–æ backend API
- Frontend –≤–æ–∑–≤—Ä–∞—â–∞–ª HTML —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤–º–µ—Å—Ç–æ JSON –¥–∞–Ω–Ω—ã—Ö

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### Backend –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–§–∞–π–ª:** `backend/src/categories/categories.controller.ts`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
1. –£–±—Ä–∞–Ω `@UseGuards(JwtAuthGuard)` —Å —É—Ä–æ–≤–Ω—è –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
2. –î–æ–±–∞–≤–ª–µ–Ω `@UseGuards(JwtAuthGuard, RolesGuard)` –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –º–µ—Ç–æ–¥–∞–º, –∫–æ—Ç–æ—Ä—ã–º –Ω—É–∂–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:
   - `POST /categories` (—Å–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ - —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω)
   - `GET /categories/admin` (—Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –¥–ª—è –∞–¥–º–∏–Ω–∞)
   - `PATCH /categories/:id` (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ - —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω)
   - `DELETE /categories/:id` (—É–¥–∞–ª–µ–Ω–∏–µ - —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω)
   - `PATCH /categories/:id/deactivate` (–¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è - —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω)

3. –ü—É–±–ª–∏—á–Ω—ã–µ endpoints –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:
   - `GET /categories` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
   - `GET /categories/:id` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –¢–µ–ø–µ—Ä—å –ª—é–±–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.

### Frontend —É–ª—É—á—à–µ–Ω–∏—è

**–§–∞–π–ª:** `frontend/src/pages/categories/index.tsx`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
1. –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ—à–∏–±–∫—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
2. –£–ª—É—á—à–µ–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—à–∏–±–æ–∫:
   - –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç "Unauthorized", –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–æ–π "–í–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É"
   - –î—Ä—É–≥–∏–µ –æ—à–∏–±–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏" –∏ —Ç–µ–∫—Å—Ç–æ–º –æ—à–∏–±–∫–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è.

### Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**–§–∞–π–ª:** `/etc/nginx/sites-available/birdwatching`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
```nginx
# –ë—ã–ª–æ:
location ~ ^/(excursions|bookings|users) {

# –°—Ç–∞–ª–æ:
location ~ ^/(excursions|bookings|users|categories|subscriptions|telegram) {
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ API endpoints —Ç–µ–ø–µ—Ä—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É—é—Ç—Å—è –Ω–∞ backend (–ø–æ—Ä—Ç 3010).

## üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```sql
SELECT id, name, "isActive", color FROM categories ORDER BY name;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 5 –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –≤ –ë–î:
- –í–æ–¥–æ–ø–ª–∞–≤–∞—é—â–∏–µ (—Ü–≤–µ—Ç: #3B82F6)
- –ì–æ—Ä–æ–¥—Å–∫–∏–µ –ø—Ç–∏—Ü—ã (—Ü–≤–µ—Ç: #8B5CF6)
- –ü–µ—Ä–µ–ª–µ—Ç–Ω—ã–µ –ø—Ç–∏—Ü—ã (—Ü–≤–µ—Ç: #F59E0B)
- –ü—Ç–∏—Ü—ã –ª–µ—Å–∞ (—Ü–≤–µ—Ç: #10B981)
- –•–∏—â–Ω—ã–µ –ø—Ç–∏—Ü—ã (—Ü–≤–µ—Ç: #EF4444)

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ API endpoint

```bash
curl https://excursionapp.mywire.org/categories
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON —Å 5 –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ (–±–µ–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

```bash
docker-compose -f docker-compose.prod.yml ps
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç:
- `birdatching-backend-1` - Up
- `birdatching-frontend-1` - Up
- `birdataching-postgres-1` - Up (healthy)
- `birdatching-redis-1` - Up

## üöÄ –î–µ–ø–ª–æ–π –∏–∑–º–µ–Ω–µ–Ω–∏–π

–°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è: `deploy-update.sh`

### –ü—Ä–æ—Ü–µ—Å—Å –¥–µ–ø–ª–æ—è:
1. –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä (SCP)
2. –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ backend –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
3. –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ frontend –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Nginx
5. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ Nginx

**–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –¥–µ–ø–ª–æ—è:**
```bash
chmod +x deploy-update.sh && ./deploy-update.sh
```

## üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

–¢–µ–ø–µ—Ä—å API endpoints —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –Ω–∞:

1. **–ü—É–±–ª–∏—á–Ω—ã–µ (–±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏):**
   - `GET /categories` - —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π
   - `GET /categories/:id` - –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è
   - `GET /excursions` - —Å–ø–∏—Å–æ–∫ —ç–∫—Å–∫—É—Ä—Å–∏–π (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
   
2. **–¢—Ä–µ–±—É—é—â–∏–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:**
   - `GET /subscriptions/my-with-categories` - –ø–æ–¥–ø–∏—Å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - `POST /subscriptions` - –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—é
   - `DELETE /subscriptions/:id` - –æ—Ç–ø–∏—Å–∞—Ç—å—Å—è
   
3. **–¢–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:**
   - `POST /categories` - —Å–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
   - `PATCH /categories/:id` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
   - `DELETE /categories/:id` - —É–¥–∞–ª–µ–Ω–∏–µ
   - `GET /categories/admin` - –≤—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–≤–∫–ª—é—á–∞—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ)

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
‚ùå –°—Ç—Ä–∞–Ω–∏—Ü–∞ `/categories` –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞ "–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"  
‚ùå API `/categories` —Ç—Ä–µ–±–æ–≤–∞–ª –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é  
‚ùå Nginx –Ω–µ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä–æ–≤–∞–ª –∑–∞–ø—Ä–æ—Å—ã –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –Ω–∞ backend

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ `/categories` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º–∏ –∏ –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏  
‚úÖ API `/categories` –¥–æ—Å—Ç—É–ø–µ–Ω –ø—É–±–ª–∏—á–Ω–æ  
‚úÖ Nginx –ø—Ä–∞–≤–∏–ª—å–Ω–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É–µ—Ç –≤—Å–µ API endpoints  
‚úÖ –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –Ω–∞ frontend

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:
```bash
# Backend
docker logs -f birdatching-backend-1

# Frontend
docker logs -f birdatching-frontend-1

# Nginx
tail -f /var/log/nginx/error.log
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤:
```bash
# Backend
docker-compose -f docker-compose.prod.yml restart backend

# Frontend
docker-compose -f docker-compose.prod.yml restart frontend

# Nginx
systemctl reload nginx
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ endpoints:
```bash
# –ö–∞—Ç–µ–≥–æ—Ä–∏–∏
curl https://excursionapp.mywire.org/categories

# –ü–æ–¥–ø–∏—Å–∫–∏ (—Ç—Ä–µ–±—É–µ—Ç —Ç–æ–∫–µ–Ω)
curl -H "Authorization: Bearer YOUR_TOKEN" \
  https://excursionapp.mywire.org/subscriptions/my-with-categories
```

## üîó –°—Å—ã–ª–∫–∏

- **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:** https://excursionapp.mywire.org/
- **–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π:** https://excursionapp.mywire.org/categories
- **API –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:** https://excursionapp.mywire.org/categories

## ‚ú® –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–í—Å–µ –ø—Ä–æ–±–ª–µ–º—ã —É—Å–ø–µ—à–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∫–∞–∫ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö, —Ç–∞–∫ –∏ –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

---

**–ê–≤—Ç–æ—Ä:** AI Assistant  
**–î–∞—Ç–∞:** 7 –æ–∫—Ç—è–±—Ä—è 2025

